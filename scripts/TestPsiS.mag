// Paramters defining the prime p = f*lA^eA*lB^eB - 1
f := 1;
lA := 2;
lB := 3;
eA := 372;
eB := 239;

Border := 1076415339332851335838408278837787304900791017342367285006484190592481075231153579549080863047304729836926607724267;

// Define the prime p
p := f*lA^eA*lB^eB-1;
assert IsPrime(p: Proof:=false);

// or, explicitly...
assert p eq
1035471774176930525297776823786680532142738964554907117011618967905467894068247\
8846502882896561066713624553211618840202385203911976522554393044160468771151816\
976706840078913334358399730952774926980235086850991501872665651576831;

// Prime field of order p
Fp := GF(p);
Fborder := GF(Border);
// The quadratic extension via x^2 + 1 since p = 3 mod 4
Fp2<i> := ExtensionField<Fp,x|x^2+1>;

// E0 is the starting curve E0/Fp2: y^2=x^3+x (the A=0 Montgomery curve)
// EA is Randall's public key curve E0/<R>
E0 := EllipticCurve([Fp2|1,0]);
// 64781088961249660023766560922
// 4247789455301520551421679316
// [350871000455207997523176462036,64781088961249660023766560922]
// [9298182360649463688840893882927707202326960651007376507897081975005447562242693280973003484307676762016769336903386968781198215330731938604253104042412556732312176022235344052396730547324673171825531375236332349486756705456516475137986768437796,6980453890030222748273521757707248406332516479021609395180468563748387105631276149969574727184180818343640179404710493340943957257798095454168627933497375230378002987998507613641063345545463896465142041060044356225205430689751]

EA := EllipticCurve([Fp2|1, 0 + 0*i]);
print IsSupersingular(E0) and IsSupersingular(EA);

// Create points psi(S), R1, and R2
psiS := EA![20822980237232112531912212748 + 51278778511252216111315483*i,125228132159772071454873118180 + 877013910730177471301131354840*i];
R1 := EA![2052111761442405241083921322120 + 151421532372212653931171585610*i,187118178183224219139992423888143 + 713614811726411377219247134156*i];
R2 := EA![12425524171173160202138121218140173 + 5921011320555831351482220320666*i,10924159824912315518921456163211 + 21423833239105219063319119175*i];
a := Fborder!156971921972241659215198628498
b := Fborder!161788118612315171211492770105

newPsiS := a*R1 + b*R2;

print psiS eq newPsiS; 
